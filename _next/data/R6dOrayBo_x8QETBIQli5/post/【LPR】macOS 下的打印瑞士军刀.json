{"pageProps":{"post":{"id":34,"title":"【LPR】macOS 下的打印瑞士军刀","created_at":"2025-11-27T06:19:00Z","updated_at":"2025-11-27T06:26:12Z","content":"# 深度解析 `lpr` 命令：Linux/macOS 下的打印瑞士军刀\n\n在 Linux 和 macOS 系统中，`lpr`（Line Printer Remote）命令是一个强大而实用的工具，它允许用户从命令行发送文件到打印队列。虽然现在图形界面的打印选项更为常见，但 `lpr` 在脚本、自动化任务以及需要精确控制打印行为的场景中依然扮演着不可或缺的角色。\n\n## `lpr` 是什么？\n\n`lpr` 是 CUPS (Common Unix Printing System) 打印系统的一部分，它负责将指定的文件发送到打印假脱机（spool）目录，然后由打印守护进程（通常是 `lpd` 或 CUPS 自身）处理并将内容发送到实际的打印机。简单来说，它就是命令行下的\"打印\"按钮。\n\n## 为什么你需要了解 `lpr`？\n\n1. **自动化和脚本编写**：在批处理、自动化报告生成或服务器端打印任务中，`lpr` 可以轻松集成到 shell 脚本中，实现无人值守的打印。\n2. **远程打印**：尽管名称中带有 \"Remote\"，但现代 CUPS 环境下，`lpr` 主要用于本地打印。不过，其背后的协议（LPD）确实支持网络打印。\n3. **精确控制**：`lpr` 提供了多种选项，允许你精确控制打印机选择、份数、纸张大小等。\n4. **诊断和故障排除**：了解 `lpr` 有助于你理解打印流程，并在打印出现问题时进行诊断。\n\n## `lpr` 的基本用法\n\n最简单的 `lpr` 命令就是将一个文件发送到默认打印机：\n\n```bash\nlpr filename.txt\n```\n\n如果 `filename.txt` 是一个文本文件，它将被直接打印。如果文件是 PostScript 或 PDF 格式，CUPS 会自动处理并将其发送到打印机。\n\n## 常用选项\n\n`lpr` 提供了丰富的选项来定制打印行为：\n\n### `-P printer_name`：指定打印机\n\n指定要使用的打印机。这是最常用的选项之一。\n\n```bash\nlpr -P MyOfficePrinter document.pdf\n```\n\n**如何查看打印机名称？**\n\n使用 `lpstat -p` 命令可以列出所有可用的打印机及其名称：\n\n```bash\nlpstat -p\n```\n\n### `-# num_copies`：指定打印份数\n\n```bash\nlpr -# 3 report.docx\n```\n\n### `-o option=value`：指定打印选项\n\n指定各种打印选项。这些选项通常与打印机驱动程序相关，非常强大和灵活。以下是一些常见示例：\n\n#### 纸张大小 (Page Size)\n\n```bash\nlpr -o media=A4 document.pdf\n```\n\n常见值：`Letter`, `Legal`, `A4`, `A3` 等。\n\n#### 双面打印 (Duplex/Two-Sided)\n\n```bash\nlpr -o Duplex=DuplexNoTumble document.pdf  # 长边翻转\nlpr -o Duplex=DuplexTumble document.pdf    # 短边翻转\n```\n\n常见值：`DuplexNoTumble` (长边翻转), `DuplexTumble` (短边翻转), `None` (单面)。\n\n#### 每页打印的页数 (N-up)\n\n将多页内容缩小打印到一张纸上。\n\n```bash\nlpr -o number-up=2 document.pdf  # 每页打印2版\n```\n\n#### 打印质量 (Quality)\n\n```bash\nlpr -o print-quality=draft document.pdf\n```\n\n常见值：`draft`, `normal`, `high`。\n\n#### 彩色/黑白 (Color/Grayscale)\n\n```bash\nlpr -o ColorModel=Grayscale document.pdf  # 强制黑白\n```\n\n常见值：`Color`, `Grayscale`。\n\n**如何获取更多 `option=value` 选项？**\n\n使用 `lpoptions -p printer_name -l` 命令可以列出特定打印机支持的所有选项及其可能的值。\n\n```bash\nlpoptions -p MyOfficePrinter -l\n```\n\n### `-r`：打印后删除文件\n\n在打印完成后删除原始文件。**请谨慎使用此选项，因为它会永久删除你的文件！**\n\n### `-m`：打印完成通知\n\n打印完成后发送邮件通知用户。\n\n## 示例：一个实际的打印脚本片段\n\n假设你有一个需要每天自动打印销售报告的场景：\n\n```bash\n#!/bin/bash\n\nREPORT_FILE=\"/var/reports/daily_sales_$(date +%Y%m%d).pdf\"\nPRINTER=\"WarehousePrinter\"\n\n# 检查报告文件是否存在\nif [ ! -f \"$REPORT_FILE\" ]; then\n  echo \"错误: 报告文件 $REPORT_FILE 不存在。\"\n  exit 1\nfi\n\necho \"正在发送报告 $REPORT_FILE 到打印机 $PRINTER ...\"\n\nlpr -P \"$PRINTER\" -o media=A4 -o Duplex=DuplexNoTumble \"$REPORT_FILE\"\n\nif [ $? -eq 0 ]; then\n  echo \"报告已成功发送到打印队列。\"\nelse\n  echo \"错误: 发送报告失败。\"\nfi\n```\n\n## 总结\n\n`lpr` 命令虽然是命令行工具，但其功能强大且灵活。通过理解其基本用法和各种选项，你可以在 Linux 和 macOS 环境下更高效地管理和自动化你的打印任务。下次当你需要从终端打印文件时，不妨尝试一下这个\"老牌\"但依然充满活力的工具！\n","author":"z0ffy","reactions":{"url":"https://api.github.com/repos/z0ffy/z0ffy.github.io/issues/34/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"labels":["published","杂记"]}},"__N_SSG":true}